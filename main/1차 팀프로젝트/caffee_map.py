import pandas as pd
import os

print("ğŸ“ í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬:", os.getcwd())       # get current working directory

base_raw_url = (
    "https://raw.githubusercontent.com/Cicada31113/ia-codyssey/main/main/"
    "1%EC%B0%A8%20%ED%8C%80%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8/%EB%B0%98%EB%8B%AC%EA%B3%B0%EC%BB%A4%ED%94%BC%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8"
)  # íŒŒì´ì¬ì€ "í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ìœ„ì¹˜" ê¸°ì¤€ìœ¼ë¡œ íŒŒì¼ ì°¾ìŒ.

                     # pandasê°€ ì½ê²Œ ë§Œë“œëŠ”ì¤‘
map_df = pd.read_csv(f'{base_raw_url}/area_map.csv')               # 3ê°œ íŒŒì¼ë¡œ í‘œ(DataFrame)ì— ë‹´ì„ê²Œ.
struct_df = pd.read_csv(f'{base_raw_url}/area_struct.csv')         # f'{ë³€ìˆ˜{}/..' 
category_df = pd.read_csv(f'{base_raw_url}/area_category.csv')     # -> ë¬¸ìì—´ ì•ˆì— ë³€ìˆ˜ê°’ì„ ë„£ì–´ì£¼ëŠ” ë¬¸ë²•(f-string)

map_df.columns = map_df.columns.str.strip()            # ì—‘ì…€ íŒŒì¼ ì•ˆì—ëŠ” êµ¬ì¡°ë¬¼ ì´ë¦„ì´ ë“¤ì–´ìˆëŠ”ë°
struct_df.columns = struct_df.columns.str.strip()      # ì—´ ì œëª©ì— ê³µë°±ì´ ë¶™ì–´ ìˆì–´ì„œ íŒŒì´ì¬ì´ "struct" ëª¾ì°¾ìŒ
category_df.columns = category_df.columns.str.strip()  # ëª¨ë“  ì—´ ì´ë¦„ì—ì„œ ì•ë’¤ ê³µë°±ì„ ì œê±°í•´ì¤˜ì•¼í•¨ -> str.strip()
                                                       # .columns -> ì—´ ì œëª©ë§Œ ë½‘ì•„ì˜¤ëŠ” ê¸°ëŠ¥
                                                       # .str.strip(): ë¬¸ìì—´ ì–‘ì˜† ë¶™ì€ ê³µë°±ì„ ì—†ì• ì¤Œ

print("ğŸ“¦ map_df ì—´:", map_df.columns.tolist())                     # .tolist() : ì—´ ëª©ë¡ì„ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ì¶œë ¥
print("ğŸ—  struct_df ì—´:", struct_df.columns.tolist())             
print("ğŸ“˜ category_df ì—´:", category_df.columns.tolist())


# area_map.csvëŠ” ë§ê·¸ëŒ€ë¡œ ì§€ë„ ì¢Œí‘œì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ. ì–´ë–¤ ê±´ë¬¼ì´ ì–´ëŠ ì§€ì—­ ì•ˆì— ìˆê³ , ì¢Œí‘œ(x,y)ë¡œ ì–´ë””ì— ìˆëŠ”ì§€ ì•Œë ¤ì¤Œ.
# are_struct.csv -> êµ¬ì¡°ë¬¼ì˜ ìœ„ì¹˜ì™€ ìˆ«ì IDë§Œ ë“¤ì–´ìˆìŒ
# are_category.csv -> ê·¸ ìˆ«ì IDì— í•´ë‹¹í•˜ëŠ” ì´ë¦„ì´ ë“¤ì–´ ìˆìŒ (1:ì•„íŒŒíŠ¸, 2:ë¹Œë”©..)
# ê·¸ë˜ì„œ ë‘ ë°ì´í„°ë¥¼ ì—°ê²°í•´ì„œ ì¢Œí‘œ&êµ¬ì¡°ë¬¼ID -> ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì¤˜ì•¼ë¨

id_to_name = dict(zip(category_df['category'], category_df['struct']))
 # id_to_name ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ID -> ì´ë¦„ì„ ì—°ê²°í•´ì£¼ëŠ” ì‚¬ì „(dictionary)ì„ ë§Œë“ ë‹¤.
   # êµ¬ì¡°ë¬¼ IDë€?
   # ìš°ë¦¬ê°€ ê°€ì§„ ë°ì´í„°ëŠ” ì§€ì—­ ì§€ë„ì— ìˆëŠ” ê±´ë¬¼ë“¤(êµ¬ì¡°ë¬¼)ì„ í‘œí˜„í•˜ëŠ”ë°
   # CSV íŒŒì¼ì„ ë³´ë©´ ê·¸ êµ¬ì¡°ë¬¼ë“¤ì˜ ì´ë¦„ì´ ë°”ë¡œ ì¨ ìˆì§€ ì•Šê³  ìˆ«ì ì½”ë“œë¡œ ë˜ì–´ìˆì–´
   # êµ¬ì¡°ë¬¼ ID [1] -> ì•„íŒŒíŠ¸ // êµ¬ì¡°ë¬¼ ID [2] -> ë¹Œë”©  ì´ëŸ°ì‹ìœ¼ë¡œ
   # ì™œ ìˆ«ìë¡œ ë˜ì–´ìˆëƒë©´, ì»´í“¨í„°ëŠ” ìˆ«ìë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²Œ í›¨ì”¬ ì‰¬ì›Œì„œ ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ì´ë ‡ê²Œ ìˆ«ìë¡œ í‘œí˜„í•˜ëŠ” ê²½ìš°ê°€ ë§ì•„
   # í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ì‚¬ëŒì´ë‹ˆê¹Œ "1"ë³´ë‹¤ëŠ” "ì•„íŒŒíŠ¸"ë¼ê³  ì¨ ìˆëŠ”ê²Œ ë³´ê¸° ì‰½ê² ì§€?
   
   # ê·¸ë˜ì„œ ì´ ìˆ«ìë“¤ì„ -> ì‚¬ëŒì´ ì´í•´í•˜ê¸° ì‰¬ìš´ ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì£¼ëŠ” ì‘ì—…ì´ ë°”ë¡œ ì•„ë˜ structue_df ë¶€ë¶„ì´ì•¼.

   # *ì¶”ê°€ìš©ì–´ì„¤ëª…*
   # zip -> ë‘ ì¤„ì„ ì§ì§“ê¸°í•˜ëŠ” ë„êµ¬ -> (1, 'ì•„íŒŒíŠ¸') ì´ëŸ°ì‹ìœ¼ë¡œ
   # dict -> ë”•ì…”ë„ˆë¦¬ (ì‚¬ì „) ë§Œë“¤ê¸°
      # ì˜ˆì‹œ:
      # dict([(1, 'ì•„íŒŒíŠ¸'), (2, 'ë¹Œë”©'), (3, 'ë°˜ë‹¬ê³°ì»¤í”¼')])
      # -> {1: 'ì•„íŒŒíŠ¸', 2: 'ë¹Œë”©', 3: 'ë°˜ë‹¬ê³°ì»¤í”¼'}
      # ì¦‰, ë‘ ë¦¬ìŠ¤íŠ¸ë¥¼ ë”•ì…”ë„ˆë¦¬ë¡œ ë²ˆí˜¸: ì´ë¦„ í˜•íƒœë¡œ ë°”ê¿”ì¤Œ -> ì´ê²Œ id_to_nameì˜ ì •ì²´


struct_df['structure'] = struct_df['category'].map(id_to_name)
 # structure_idë¼ëŠ” ìˆ«ì ì½”ë“œë¥¼, ìš°ë¦¬ê°€ ë§Œë“  ì‚¬ì „ì„ ì´ìš©í•´ ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤. 

   # *ì¶”ê°€ìš©ì–´ì„¤ëª…*
   # map -> ë³€í™˜ê¸° ì—­í•                  ----> mapì€ "ì´ ìˆ«ìì— í•´ë‹¹í•˜ëŠ” ì´ë¦„ì´ ë­ì•¼?" ë¼ê³  ë¬¼ì–´ì„œ í•˜ë‚˜ì”© ë°”ê¿”ì£¼ëŠ” ì—­í• .
   # ì˜ˆì‹œ :                                  
   # id_to_name = {                         # map()ì€ ê° ìˆ«ìë¥¼ ë”•ì…”ë„ˆë¦¬ì—ì„œ ì°¾ì•„ì„œ ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì¤Œ
   #     1: 'ì•„íŒŒíŠ¸',                         # ê·¸ëŸ°ë° ! category == 0 ì¸ ê°’ì€ ë”•ì…”ë„ˆë¦¬ì— ì—†ìŒ
   #     2: 'ë¹Œë”©',                           # ë”•ì…”ë„ˆë¦¬ì— ì—†ëŠ” ê°’ì€ -> NaN ìœ¼ë¡œ ë°”ë€œ 
   #     3: 'ë°˜ë‹¬ê³°ì»¤í”¼'                        # ë§Œì•½ NaN ì œê±°í•˜ê³  ì‹¶ìœ¼ë©´, 
   # }                                         # area1_df = area1_df.drpna(subset=['structure']) ì“°ë©´ë¨
   # êµ¬ì¡°ë¬¼_id_ë¦¬ìŠ¤íŠ¸ = [1, 3, 2]                 # "structure ì—´ì´ ë¹„ì–´ ìˆëŠ” ê±´ ë²„ë ¤ì¤˜" ë¼ëŠ” ëœ».
   # [1, 3, 2].map(id_to_name) ---> ['ì•„íŒŒíŠ¸', 'ë°˜ë‹¬ê³°ì»¤í”¼', 'ë¹Œë”©']

merged_df = pd.merge(struct_df, map_df, on=['x', 'y'])  # ë³‘í•© ê¸°ì¤€ì—, map_dfì—ëŠ” 'area'ë¼ëŠ” ì—´ì´ì—†ìŒ.
                                                        # ë‘ íŒŒì¼ ëª¨ë‘ ê³µí†µìœ¼ë¡œ ê°–ê³  ìˆëŠ” ì—´ë§Œ ë³‘í•©ê¸°ì¤€ìœ¼ë¡œ ì“°ì.
                                                            


 # pd.merge(...) -> ë‘ ê°œì˜ í‘œ(ë°ì´í„°í”„ë ˆì„)ë¥¼ í•©ì¹˜ëŠ” í•¨ìˆ˜. // SQLì—ì„œ ë§í•˜ëŠ” JOINê³¼ ê°™ì€ ê°œë…
    # ì™¼ìª½ í‘œ : êµ¬ì¡°ë¬¼ ì •ë³´ (ì–´ë–¤ ê±´ë¬¼ì¸ì§€, ì´ë¦„ ë“±)
    # ì˜¤ë¥¸ìª½ í‘œ : ì§€ë„ ì •ë³´ (ê·¸ ì¢Œí‘œê°€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ê°€)
 
 # on=['area', 'x', 'y']
    # ë‘í‘œë¥¼ í•©ì¹  ë•Œ ê¸°ì¤€ì´ ë˜ëŠ” ê³µí†µëœ ì—´(column) ì´ë¦„
    # ì¦‰ "ê°™ì€ ì§€ì—­ë²ˆí˜¸,xì¢Œí‘œ,yì¢Œí‘œ"ê°€ ìˆëŠ” ì¤„ì„ ì„œë¡œ ì—°ê²°í•˜ê²Œë¨.

area1_df = merged_df[merged_df['area'] == 1]   # -> areaê°€ 1ì¸ í–‰ë§Œ ê³¨ë¼ë‚´ì„œ 'area1_df'ë¼ëŠ” í‘œë¡œ ë§Œë“¤ê±°ì„
print("\nğŸ§¾ area1 ë°ì´í„° ìƒ˜í”Œ:")
print(area1_df.head())
print("\nğŸ“Š êµ¬ì¡°ë¬¼ ì¢…ë¥˜ë³„ ê°œìˆ˜:")
print(area1_df['structure'].value_counts())


############################# ì—¬ê¸°ì„œë¶€í„°ëŠ” ì‹œê°í™”í• ê±°ì„. matplotlib.pyplot ì“¸ê²¨ (ê·¸ë˜í”„/ì´ë¯¸ì§€ ê·¸ë¦¬ëŠ” ë„êµ¬)